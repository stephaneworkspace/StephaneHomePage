@page "/astrologie"
@inject Microsoft.AspNetCore.Components.NavigationManager NavigationManager
@inject IMatToaster Toaster
@inject IAstrologieServiceHttp AstrologieServiceHttp
@using Services.Http
@using System.Net
@using Newtonsoft.Json
@using Struct.ImportJson
<AppBar Title="Astrologie" />
<MatAppBarContent>
    @if (swLoaded)
    {
        <ThemeAstral Json="data" MaxWidth="500" MaxHeight="500" />
    }
</MatAppBarContent>
@code {
    ImportJson data;
    bool swLoaded = false;
    protected override async Task OnInitializedAsync()
    {
        await LoadDatas();
    }

    private async Task LoadDatas()
    {
        var response = await AstrologieServiceHttp.GetThemeAstral();
        switch (response.StatusCode)
        {
            case HttpStatusCode.OK:
                string content = await response.Content.ReadAsStringAsync();
                data = JsonConvert.DeserializeObject<ImportJson>(content);
                swLoaded = true;
                break;
            default:
                Toaster.Add("Impossible de recevoir les données par http", MatToastType.Danger, "Erreur http " + response.StatusCode, "danger");
                NavigationManager.NavigateTo("/");
                break;
        }
    }
}